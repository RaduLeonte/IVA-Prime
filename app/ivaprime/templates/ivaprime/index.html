{% load static %}
<!-- Made by:
    Radu Cristian Leonte
    (raducristian.leonte@gmail.com) -->
    <!DOCTYPE html>
    <html>
        <head>
            <title>IVA Prime</title>
            <!-- Styling -->
            <link rel="icon" href="{% static 'iva-prime.ico' %}">
            <link href="https://fonts.googleapis.com/css2?family=Anonymous+Pro&display=swap" rel="stylesheet">
            <link rel="stylesheet" type="text/css" href="{% static 'styles.css' %}">
            <!-- Scripts -->
            <script src="{% static 'js/globalVariables.js' %}"></script>
            <script src="{% static 'js/plasmidDemoFile.js' %}"></script>
            <script src="{% static 'js/getTM.js' %}"></script>
            <script src="{% static 'js/importPlasmid.js' %}"></script>
            <script src="{% static 'js/sequenceContextMenu.js' %}"></script>
            <script src="{% static 'js/tableHover.js' %}"></script>
            <script src="{% static 'js/sequenceCursor.js' %}"></script>
            <script src="{% static 'js/tableSelection.js' %}"></script>
            <script src="{% static 'js/createPrimers.js' %}"></script>
            <script src="{% static 'js/insertionPopUpWindow.js' %}"></script>
            <script src="{% static 'js/scrollToAnnotation.js' %}"></script>
            <script src="{% static 'js/customSearch.js' %}"></script>
            <script src="{% static 'js/resizeContents.js' %}"></script>
            <script src="{% static 'js/hideableWindows.js' %}"></script>
            <script src="{% static 'js/editFeatures.js' %}"></script>
            <script src="{% static 'js/plasmidTabs.js' %}"></script>
            <!-- Libraries -->
            <script src="{% static 'js/html-docx.js' %}"></script>
            <script src="{% static 'js/xlsx.full.min.js' %}"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.2.1/exceljs.min.js"></script>
        </head>
        <body>
            <header>
                <nav>
                    <!-- Left side header buttons -->
                    <ul id="header-list"  class="horizontal-list">
                        <li id="import-btn"><a href="#" id="import-btn-a">Import File</a></li>
                        <li id="import-demo-btn"><a href="#">Try Demo File</a></li>
                        <li id="import-second-btn" style="display: none;"><a href="#">Import Subcloning Target</a></li>
                        <li id="import-second-demo-btn" style="display: none;"><a href="#" id="import-second-btn-a">Import Demo Subcloning Target</a></li>
                        <li style="display: flex;align-items: center;text-align: center;"><a id="plasmid-file-name1" class="editable" style="display: none;"></a></li>
                        <li style="display: flex;align-items: center;text-align: center;"><a id="plasmid-file-name2" class="editable" style="display: none;"></a></li>
                    </ul>

                    <!-- Plasmid tabs -->
                    <div id="scroll-left" onclick="scrollTabs('left')">‹</div>
                    <div id="plasmid-tabs-container">
                        <ul id="plasmid-tabs-list">
                        </ul>
                    </div>
                    <div id="scroll-right" onclick="scrollTabs('right')">›</div>

                    <!-- Right side header buttons -->
                    <ul id="header-list-right" class="horizontal-list">
                        <li id="tm-calc-btn"><a href="#" disabled>TM Calculator</a></li>
                        <li id="settings-btn" class="svg-icon-btn"><a href="#" disabled style="background-image: url('{% static 'settings_icon.svg' %}')"></a></li>
                        <li id="info-btn" class="svg-icon-btn"><a href="#" disabled style="background-image: url('{% static 'info_icon.svg' %}')"></a></li>
                    </ul>
                </nav>
            </header>
    
            <!-- Hideable windows -->
            <div>
                <!-- TM Calculator window -->
                <div id="tm-calc-window" class="hideable-window" style="display: none;">
                    <h1>Calculate melting temperatures</h1>
                    <div>
                        <label for="tm-calc-primer-input1">Primer 1 TM = <span id="tm-calc-primer-tm1">--</span> °C <span id="tm-calc-info-span1" style="display: block;"></span></label>
                        <input type="text" id="tm-calc-primer-input1"  class="popup-window-input">
                    </div>
                    <div>
                        <label for="tm-calc-primer-input2">Primer 2 TM = <span id="tm-calc-primer-tm2">--</span> °C <span id="tm-calc-info-span2" style="display: block;"></span></label>
                        <input type="text" id="tm-calc-primer-input2"  class="popup-window-input">
                    </div>
                </div>
                <!-- Settings window -->
                <div id="settings-window" class="hideable-window" style="display: none;">
                    <div class="tabs-btns-list">
                        <ul class="horizontal-list">
                            <li><a class="standard-btn-a settings-tab-button settings-tab-button-highlighted" onClick="slideTab(this, 'basic')" href=# disabled="true">Basic</a></li>
                            <li><a class="standard-btn-a settings-tab-button" onClick="slideTab(this, 'advanced')" href=# disabled="false">Advanced</a></li>
                        </ul>
                        <ul class="horizontal-list horizontal-list-right">
                            <li><a id="reset-default-settings-btn" class="standard-btn-a reset-default-settings-btn" href=#>Reset Default Settings</a></li>
                            <li><a id="save-settings-btn" class="standard-btn-a save-settings-btn" href=#>Save Settings</a></li>
                        </ul>
                    </div>
                    <div class="tabs">

                        <!-- Basic settings -->
                        <div class="tab basic-settings">
                            <h1> Basic Settings</h1>

                            <div class="settings-group">
                                <h3>Primer generation settings:</h3>
                                <div class="settings-window-row">
                                    <label for="primerDistributionSettingsElement">Distribute insertion across primer pairs:</label>
                                    <input type="checkbox" id="primerDistributionSettingsElement" name="primerDistributionSettingsElement" checked="false">
                                </div>
                            </div>

                            <div class="settings-group">
                                <h3>Appearance settings:</h3>

                                <div class="settings-window-row">
                                    <label for="colorThemeSettingsElement">Theme:</label>
                                    <select id="colorThemeSettingsElement" name="colorThemeSettingsElement">
                                        <option value="lightTheme">Light</option>
                                        <option value="darkTheme" disabled>Dark</option>
                                    </select>
                                </div>
            
                                <div class="settings-window-row">
                                    <label for="gridWidthSettingsElement">Grid size (bases per row):</label>
                                    <input type="number" id="gridWidthSettingsElement" name="gridWidthSettingsElement" min="10" max="9999" value="60">
                                </div>
                            </div>
                        </div>

                        <!-- Advanced settings -->
                        <div class="tab advanced-settings" style="position: absolute; transform: translateX(100%);">   
                            <h1>Advanced Settings</h1>

                            <div class="settings-group">
                                <h3>Template binding region melting temperature parameters:</h3>
            
                                <!-- Algorithm -->
                                <h4>Calculator</h4>
                                <div class="settings-window-row">
                                    <label for="primerConcSettingsElement">Primer concentration [nM]:</label>
                                    <input type="text" id="primerConcSettingsElement" name="primerConcSettingsElement">
                                </div>
                                <div class="settings-window-row">
                                    <label for="meltingTempAlgorithmChoiceSettingsElement">Calculator Algorithm:</label>
                                    <select id="meltingTempAlgorithmChoiceSettingsElement" name="meltingTempAlgorithmChoiceSettingsElement">
                                        <option value="nnSantaLucia">Nearest-neighbor (SantaLucia)</option>
                                        <option value="oligoCalc">Basic (Oligo Calc)</option>
                                    </select>
                                </div>
                                <img id ="meltingTempAlgorithmEquationImage" src="{% static 'nnSantaLucia equation.png' %}" alt="Melting temperature equation." style="max-width: 100%; height: 50px;">
            
                                <!-- Salt correction -->
                                <h4>Salt Correction</h4>            
                                <div class="settings-window-row">
                                    <label for="saltConcSettingsElement">Salt concentration [M]:</label>
                                    <input type="text" id="saltConcSettingsElement" name="saltConcSettingsElement">
                                </div>
                                <div class="settings-window-row">
                                    <label for="saltCorrectionEquationSettingsElement">Salt correction equation:</label>
                                    <select id="saltCorrectionEquationSettingsElement" name="saltCorrectionEquationSettingsElement">
                                        <option value="SchildkrautLifson">Schildkraut-Lifson</option>
                                        <option value="Owczarzy">Owczarzy</option>
                                    </select>
                                </div>
                                <img id ="saltCorrectionEquationImage" src="{% static 'SchildkrautLifson equation.png' %}" alt="Salt correction equation." style="max-width: 100%; height: 30px;">
                                
                                <!-- DMSO correction -->
                                <h4>DMSO Correction</h4> 
                                <div class="settings-window-row">
                                    <label for="dmsoConcSettingsElement">DMSO concentration [M]:</label>
                                    <input type="text" id="dmsoConcSettingsElement" name="dmsoConcSettingsElement">
                                </div>
                                <img id ="dmsoCorrectionEquationImage" src="{% static 'DMSO equation.png' %}" alt="DMSO correction equation." style="max-width: 100%; height: 25px;">
                            </div>
            
                            <div class="settings-group">
                                <h3>Primer generation settings:</h3>
                                <div class="settings-window-row">
                                    <label for="homoRegionMinLengthSettingsElement">Homologous region minimum length [bp]:</label>
                                    <input type="text" id="homoRegionMinLengthSettingsElement" name="homoRegionMinLengthSettingsElement">
                                </div>
                                <div class="settings-window-row">
                                    <label for="homoRegionTmSettingsElement">Homologous region target TM [°C]:</label>
                                    <input type="text" id="homoRegionTmSettingsElement" name="homoRegionTmSettingsElement">
                                </div>
                                <div class="settings-window-row">
                                    <label for="tempRegionTmSettingsElement">Template binding region target TM [°C]:</label>
                                    <input type="text" id="tempRegionTmSettingsElement" name="tempRegionTmSettingsElement">
                                </div>
                                <div class="settings-window-row">
                                    <label for="upperBoundShortInsertionsSettingsElement">Upper bound short insertions TM [°C]:</label>
                                    <input type="text" id="upperBoundShortInsertionsSettingsElement" name="upperBoundShortInsertionsSettingsElement">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    
                <!-- Info window -->
                <div id="info-window" class="hideable-window" style="display: none;">
                    <h1>IVA Prime</h1>
                    <p>This web application allows you to import plasmid files (.gb and .dna), and then easily generate primers for
                        IVA Cloning by editing the DNA sequence as you wish. The primer design technique is originally based on the work
                        by García-Nafría et al.
                    </p>
                    <h3>Links:</h3>
                    <ul>
                        <li>Original paper by García-Nafría et al.: <a href="https://www.nature.com/articles/srep27459">DOI: 10.1038/srep27459</a></li>
                        <li>Source code: <a href="https://github.com/RaduLeonte/IVA-Prime">GitHub Repository</a></li>
                    </ul>
                    <h2>Guides</h2>
                        <h3>Importing</h3>
                        <ol>
                            <li><p>Click on <span id="import-btn"><a class="info-window-btn" href="#">Import File</a></span> to import either a
                                .gb or .dna file. (Or click <span id="import-demo-btn"><a class="info-window-btn" href="#">Try Demo File</a></span> to import an empty pET-28a(+)
                                vector.)</p>
                            </li>
                            <li>Navigate using the sequence grid on the right or by clicking on a specific feature in the sidebar.</li>
                            <li>Import a second plasmid by clicking <span id="import-second-btn"><a class="info-window-btn" href="#">Import Subcloning Target</a></span>. The second plasmid only serves
                                as a subcloning <i>target</i> and cannot be edited like the first plasmid.
                            </li>
                        </ol>

                        <h3>Insertions</h3>
                        <ol>
                            <li>Left click at the position you would like to insert a sequence.
                                <img src="{% static 'insertion position selection.gif' %}">
                            </li>
                            <li>Right-click to open the context menu and select <span class="info-window-menu-btn">Insert here</span>.
                                <img src="{% static 'insertion menu item selection.gif' %}">
                            </li>
                            <li>Enter a DNA or amino acid sequence to insert.</li>
                            <li>Select a target organism for codon optimisation (Escherichia coli, human, yeast etc.).</li>
                            <li>Press <button id="create-primers-button" class="info-window-create-primers-btn">Create Primers</button>.</li>
                        </ol>

                        <h3>Deletions</h3>
                        <ol>
                            <li>Select a region to be deleted.
                                <img src="{% static 'deletion selection.gif' %}" alt="Selecting region to be deleted.">
                            </li>
                            <li>Right-click to open the context menu and select <span class="info-window-menu-btn">Delete selection</span>.
                                <img src="{% static 'deletion menu item selection.gif' %}">
                            </li>
                        </ol>

                        <h3>Mutations</h3>
                        <ol>
                            <li>Select a region to be mutated.
                                <img src="{% static 'mutation selection.gif' %}">
                            </li>
                            <li>Right-click to open the context menu and select <span class="info-window-menu-btn">Mutate selection</span>.
                                <img src="{% static 'mutation menu item selection.gif' %}">
                            </li>
                            <li>Enter a DNA or amino acid sequence to replace the selection with.</li>
                            <li>Select a target organism for codon optimisation (Escherichia coli, human, yeast etc.).</li>
                            <li>Press <button id="create-primers-button" class="info-window-create-primers-btn">Create Primers</button>.</li>
                        </ol>

                        <h3>Subcloning</h3>
                        <ol>
                            <li>Import a second plasmid to serve as the subcloning target by clicking <span id="import-second-btn"><a class="info-window-btn" href="#">Import Subcloning Target</a></span>.</li>
                            <li>In the subcloning origin plasmid, select a region to be subcloned.
                                <img src="{% static 'subcloning selection.gif' %}">
                            </li>
                            <li>Right-click to open the context menu and select <span class="info-window-menu-btn">Subclone selection</span>.
                                <img src="{% static 'subcloning menu item selection.gif' %}">
                            </li>
                            <li>In the subcloning target plasmid, press left-click at the position you would like to subclone into
                                <img src="{% static 'subcloning pure insertion.gif' %}">
                                <i>or</i> select a region to be replaced by the subcloned sequence.
                                <img src="{% static 'subcloning replacement.gif' %}"></li>
                        </ol>

                        <h3>Saving the primers and modified plasmid to file</h3>
                        <ul>
                            <li>Click <button id="create-primers-button" class="info-window-create-primers-btn">Export Primers</button>
                                in the sidebar to save the primers as a text document or as a table.</li>
                            <li>Click <button id="create-primers-button" class="info-window-create-primers-btn">Save File</button> 
                                to save the modified plasmid file as either a .gb or a .dna file.</li>
                        </ul>
                </div>
            </div>
            
            <!-- Main container -->
            <div class="parent-container" id="parent-container">
                <!-- Plasmid nr 1 -->
                <div class="first-plasmid-container" id="first-plasmid-container">
                    
                    <!-- Sidebar -->
                    <div id="sidebar" class="sidebar" style="width: 25%;">
                        <!-- Export buttons -->
                        <div style="display: flex;">
                            <div id="export-dropdown" class="dropdown" style="display: none;">
                                <button class="save-button">Save File</button>
                                <div class="dropdown-content">
                                    <a id="export-btn-gb" href="#">GB File</a>
                                    <a id="export-btn-dna" href="#">DNA File</a>
                                </div>
                            </div>
            
                            <div id="export-dropdown-second" class="dropdown" style="display: none;">
                                <button class="save-button">Save Second File</button>
                                <div class="dropdown-content">
                                    <a id="export-second-btn-gb" href="#">GB File</a>
                                    <a id="export-second-btn-dna" href="#">DNA File</a>
                                </div>
                            </div>
    
                            <div id="export-primers-dropdown" class="dropdown" style="display: none;">
                                <button class="save-button">Export Primers</button>
                                <div class="dropdown-content">
                                    <a id="export-primers-txt" href="#">Plain Text (.txt)</a>
                                    <a id="export-primers-doc" href="#">MS Word File (.doc)</a>
                                    <a id="export-primers-csv" href="#">CSV File (.csv)</a>
                                    <a id="export-primers-xlsx" href="#">Excel File (.xlsx)</a>
                                    <a id="export-primers-microsynth" href="#">Microsynth Order Form (.xlsx)</a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Main sidebar content where primers are appended -->
                        <div class="sidebar-content">
                            <h2 id="primers-type">Primers will appear here.</h2>
                        </div>
                        <!-- Features table -->
                        <table id="sidebar-table" class="sidebar-table">
                        </table>
                    </div>
                    
                    <!-- Plasmid content -->
                    <div class="content" id="content">
                        <!-- Custom search -->
                        <input type="text" id="custom-search-input" class="search-bar" placeholder="Search">  
                        <!-- Plasmid sequence grid-->
                        <div id="file-content" class="strands">
                        </div>
                    </div>
                </div>
            </div>
        </body>
    </html>